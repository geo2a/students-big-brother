<!DOCTYPE html>
<html>
<head>

<title>Students Big Brother</title>

<style>
  
    body {
        background-image: url("resources/background.jpg");
    }

    .container {
        background-color: white;
        width: 800px;
        padding: 10px;
        margin: auto;
        border-radius: 3px;
        box-shadow: 0px 0px 10px 7px rgba(88,88,88,0.25);
    }

    .students-list-container {
        margin-top: 20px;
        margin-bottom: 50px;
        width: 1000px;
    }

    .main-container {
     
    }

    .student-icon {
        display: inline-block;
        width: 20px;
        height: 20px;
        border: 2px solid #3F51B5;
        margin: 5px;
    }

</style>

<script type = "text/javascript" 
        src = "http://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js">
</script>
<script src="lodash.js"></script>
<script type="text/javascript">
    $(document).ready(function(){
        var xmlhttp = new XMLHttpRequest();
        var url = "http://127.0.0.1:8083/files";

        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                var sourceFiles = JSON.parse(xmlhttp.responseText);
                
                // calculate unique user ids
                var uids = _.chain(sourceFiles)
                    .map(function(file) {
                        return file.uid;
                    })
                    .uniq()
                    .value();
                console.log(uids);

                // build students list on the ui
                var studsList = document.getElementById("students-list");

                _.forEach(uids, function(uid) {
                    var studIcon = document.createElement("div");
                    studIcon.setAttribute("class", "student-icon");
                    studIcon.appendChild(document.createTextNode(
                        uid
                    ));
                    studsList.appendChild(studIcon);
                });

                // console.log(sourceFiles);
                // var list = document.getElementById("files-list");
                // for (var i in sourceFiles) {
                //     var listItem = document.createElement("li");
                //     listItem.appendChild(document.createTextNode(
                //         JSON.stringify(sourceFiles[i], null, 2)
                //     ));
                //     list.appendChild(listItem);
                // }
            }
        };

        xmlhttp.open("GET", url, true);
        xmlhttp.send();
    });

</script>

</head>
<body>

<div class="container students-list-container" id="students-list">
</div>

<div class="container main-container">
    Students files
    <ul id="files-list">
        
    </ul>
</div>

</body>
</html>